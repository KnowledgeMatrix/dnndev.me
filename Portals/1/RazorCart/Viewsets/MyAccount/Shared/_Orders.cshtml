@inherits DotNetNuke.Web.Mvc.Framework.DnnWebViewPage<RazorCart.MyAccount.Models.AccountModel>
@using DotNetNuke.Web.Mvc.Helpers;

<div class="rzc-basket" ng-if="!account.detailMode">
    <div class="table-responsive">
        <table class="table table-striped table-hover table-condensed">
            <thead>
                <tr>
                    <th>@Dnn.LocalizeString("OrderNo")</th>
                    <th>@Dnn.LocalizeString("Date")</th>
                    <th>@Dnn.LocalizeString("Shipping")</th>
                    <th>@Dnn.LocalizeString("Status")</th>
                    <th class="text-right">@Dnn.LocalizeString("Total")</th>
                    <th class="text-right">@Dnn.LocalizeString("Paid")</th>
                    <th class="text-right">@Dnn.LocalizeString("Balance")</th>
                    <th></th>
                </tr>
            </thead>
            <tbody ng-if="account.orders.length > 0">
                <tr ng-repeat="order in account.orders">
                    <td>{{order.OrderID}}</td>
                    <td>{{order.OrderDate | date : '@Model.Culture.DateTimeFormat.ShortDatePattern'}}</td>
                    <td>{{order.ShipMethod}}</td>
                    <td>{{order.Status}}</td>
                    <td class="text-right">{{order.GrandTotal | currency : '@Model.Culture.NumberFormat.CurrencySymbol' : @Model.Culture.NumberFormat.CurrencyDecimalDigits}}</td>
                    <td class="text-right">{{order.PayTotal | currency : '@Model.Culture.NumberFormat.CurrencySymbol' : @Model.Culture.NumberFormat.CurrencyDecimalDigits}}</td>
                    <td class="text-right">{{order.GrandTotal - order.PayTotal | currency : '@Model.Culture.NumberFormat.CurrencySymbol' : @Model.Culture.NumberFormat.CurrencyDecimalDigits}}</td>
                    <td class="text-right">
                        <i class="fa fa-folder-open fa-lg" role="button" ng-click="account.viewOrder($index)"></i>
                        <i class="fa fa-print fa-lg" role="button" ng-click="account.print($index)" onclick="if (window.opener) window.print()"></i>
                    </td>
                </tr>
            </tbody>
            <tbody ng-if="account.orders.length < 1">
                <tr>
                    <td colspan="6">@Dnn.LocalizeString("NoOrders")</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<div class="row form-horizontal" ng-if="account.detailMode">
    <div class="col-lg-4">
        <div class="panel panel-default">
            <div class="panel-heading">
                <span class="panel-title text-uppercase">@Dnn.LocalizeString("GeneralDetails")</span>
            </div>
            <div class="panel-body details">
                <div class="form-group">
                    <label class="col-xs-4 control-label">@Dnn.LocalizeString("OrderNo")</label>
                    <div class="col-xs-8">
                        <label class="form-control">{{account.order.OrderID}}</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-xs-4 control-label">@Dnn.LocalizeString("OrderDate")</label>
                    <div class="col-xs-8">
                        <label class="form-control label-ellipsis">{{account.order.OrderDate | date : '@(Model.Culture.DateTimeFormat.ShortDatePattern + " " + Model.Culture.DateTimeFormat.ShortTimePattern.Replace("tt", "a"))'}}</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-xs-4 control-label">@Dnn.LocalizeString("Status")</label>
                    <div class="col-xs-8">
                        <label class="form-control label-ellipsis">{{account.order.Status}}</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-xs-4 control-label">@Dnn.LocalizeString("ShipDate")</label>
                    <div class="col-xs-8">
                        <label class="form-control label-ellipsis">{{account.order.ShipDate > account.sqlMinDate ? account.order.ShipDate : ''}}</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-xs-4 control-label">@Dnn.LocalizeString("TrackingNo")</label>
                    <div class="col-xs-8">
                        <label class="form-control label-ellipsis">{{account.order.TrackingNumber}}</label>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-4">
        <div class="panel panel-default">
            <div class="panel-heading">
                <span class="panel-title text-uppercase">@Dnn.LocalizeString("ShippingDetails")</span>
            </div>
            <div class="panel-body details">
                <div class="form-group">
                    <label class="col-xs-4 control-label">@Dnn.LocalizeString("Name")</label>
                    <div class="col-xs-8">
                        <label class="form-control label-ellipsis">{{account.order.ShipFirstName + ' ' + account.order.ShipLastName}}</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-xs-4 control-label">@Dnn.LocalizeString("Address")</label>
                    <div class="col-xs-8">
                        <label class="form-control label-ellipsis">{{account.order.ShipAddress1 + ' ' + account.order.ShipAddress2}}</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-xs-4 control-label"></label>
                    <div class="col-xs-8">
                        <label class="form-control label-ellipsis">{{account.order.ShipCity + ',' + account.order.ShipState + ' ' + account.order.ShipZipcode + ', ' + account.order.ShipCountry}}</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-xs-4 control-label">@Dnn.LocalizeString("ShipMethod")</label>
                    <div class="col-xs-8">
                        <label class="form-control label-ellipsis">{{account.order.ShipMethod}}</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-xs-4 control-label">@Dnn.LocalizeString("ShipNotes")</label>
                    <div class="col-xs-8">
                        <label class="form-control label-ellipsis">{{account.order.SpecialInstructions}}</label>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-4">
        <div class="panel panel-default">
            <div class="panel-heading">
                <span class="panel-title text-uppercase">@Dnn.LocalizeString("BillingDetails")</span>
            </div>
            <div class="panel-body details">
                <div class="form-group">
                    <label class="col-xs-4 control-label">@Dnn.LocalizeString("BillingName")</label>
                    <div class="col-xs-8">
                        <label class="form-control label-ellipsis">{{account.payment.BillingName}}</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-xs-4 control-label">@Dnn.LocalizeString("Address")</label>
                    <div class="col-xs-8">
                        <label class="form-control label-ellipsis">{{account.payment.BillingAddress}}</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-xs-4 control-label"></label>
                    <div class="col-xs-8">
                        <label class="form-control label-ellipsis">{{account.payment.BillingCity + ',' + account.payment.BillingState + ' ' + account.payment.BillingZip + ', ' + account.payment.BillingCountry}}</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-xs-4 control-label">@Dnn.LocalizeString("PaymentMethod")</label>
                    <div class="col-xs-8">
                        <label class="form-control label-ellipsis">{{account.payment.PayType}}</label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-xs-4 control-label">@Dnn.LocalizeString("TransID")</label>
                    <div class="col-xs-8">
                        <label class="form-control label-ellipsis">{{account.payment.TransID}}</label>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="rzc-basket" ng-if="account.detailMode">
    <div class="table-responsive">
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>@Dnn.LocalizeString("SKU")</th>
                    <th>@Dnn.LocalizeString("ProductName")</th>
                    <th class="text-right">@Dnn.LocalizeString("UnitCost")</th>
                    <th class="text-right">@Dnn.LocalizeString("Quantity")</th>
                    <th class="text-right">@Dnn.LocalizeString("LineTotal")</th>
                </tr>
            </thead>
            <tbody ng-repeat="item in account.order.OrderDetails">
                <tr>
                    <td>{{item.ProductSKU}}</td>
                    <td>
                        {{item.ProductName}}
                        <ul ng-if="item.DetailVariants.length > 0">
                            <li ng-repeat="variant in item.DetailVariants">
                                {{variant.VariantHasText ? (variant.VariantName + ': ' + variant.VariantText) : (variant.VariantGroup + ': ' + variant.VariantName)}}
                            </li>
                        </ul>
                        <ul ng-if="item.DetailBooking.IsBooking">
                            <li ng-if="item.DetailBooking.BookingStart">
                                @Dnn.LocalizeString("StartDate"): {{item.DetailBooking.BookingStart | date: [item.DetailBooking.ShowTime ? '@(Model.Culture.DateTimeFormat.ShortDatePattern + " " + Model.Culture.DateTimeFormat.ShortTimePattern.Replace("tt", "a"))' : '@Model.Culture.DateTimeFormat.ShortDatePattern'] }}
                            </li>
                            <li ng-if="item.DetailBooking.BookingEnd">
                                @Dnn.LocalizeString("EndDate"): {{item.DetailBooking.BookingEnd | date: [item.DetailBooking.ShowTime ? '@(Model.Culture.DateTimeFormat.ShortDatePattern + " " + Model.Culture.DateTimeFormat.ShortTimePattern.Replace("tt", "a"))' : '@Model.Culture.DateTimeFormat.ShortDatePattern'] }}
                            </li>
                        </ul>
                        <ul ng-if="item.DetailRecurring.IsRecurring">
                            <li>
                                <span ng-switch="item.DetailRecurring.SubscriptionInterval">
                                    {{item.DetailRecurring.RecurringOccurances == 9999 ? '@Dnn.LocalizeString("Ongoing")' : (item.DetailRecurring.RecurringOccurances + ' @Dnn.LocalizeString("Times")')}}
                                    <span ng-switch-when="Weekly">
                                        @Dnn.LocalizeString("WeeklyRecurring")
                                    </span>
                                    <span ng-switch-when="2Weeks">
                                        @Dnn.LocalizeString("2WeeksRecurring")
                                    </span>
                                    <span ng-switch-when="Monthly">
                                        @Dnn.LocalizeString("MonthlyRecurring")
                                    </span>
                                    <span ng-switch-when="2Months">
                                        @Dnn.LocalizeString("2MonthsRecurring")
                                    </span>
                                    <span ng-switch-when="Quarterly">
                                        @Dnn.LocalizeString("QuarterlyRecurring")
                                    </span>
                                    <span ng-switch-when="Semiannual">
                                        @Dnn.LocalizeString("SemiannualRecurring")
                                    </span>
                                    <span ng-switch-when="Yearly">
                                        @Dnn.LocalizeString("YearlyRecurring")
                                    </span>
                                    {{item.DetailRecurring.StartDate | date: ['@Model.Culture.DateTimeFormat.ShortDatePattern']}}
                                </span>
                            </li>
                        </ul>
                    </td>
                    <td class="text-right">{{item.UnitCost | currency : '@Model.Culture.NumberFormat.CurrencySymbol' : @Model.Culture.NumberFormat.CurrencyDecimalDigits}}</td>
                    <td class="text-right">{{item.Quantity | number : 2}}</td>
                    <td class="text-right">{{item.UnitCost * item.Quantity | currency : '@Model.Culture.NumberFormat.CurrencySymbol' : @Model.Culture.NumberFormat.CurrencyDecimalDigits}}</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<div class="row" ng-if="account.detailMode">
    <div class="col-xs-4 text-left">
        <input type="button" class="btn btn-default" value="@Dnn.LocalizeString("Back")" ng-click="account.detailMode = false" />
    </div>
    <div class="col-xs-8 text-right">
        <input type="button" class="btn btn-danger" value="@Dnn.LocalizeString("CancelSubscription")" ng-if="account.subscription" ng-disabled="!account.subscription.Active" ng-click="account.unsubscribe()" />
        <input type="button" class="btn btn-primary" value="@Dnn.LocalizeString("Print")" ng-click="account.print()" onclick="if (window.opener) window.print()" />
    </div>
</div>